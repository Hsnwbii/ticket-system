{% extends 'events/base.html' %}
{% load humanize %}

{% block content %}
<div class="text-center mb-5">
    <h1 class="fw-bold text-dark">رویدادهای پیش‌رو</h1>
    <p class="text-muted">خرید بلیط بهترین کنسرت‌ها و همایش‌های ایران</p>
</div>

<div class="row">
    {% for event in events %}
    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <!-- تصویر -->
            <img src="https://placehold.co/600x400/2575fc/white?text={{ event.title }}" class="card-img-top" alt="Event">
            
            <div class="card-body d-flex flex-column">
                <div class="d-flex justify-content-between align-items-start mb-2">
                    <h5 class="card-title fw-bold text-primary">{{ event.title }}</h5>
                    <span class="badge bg-success rounded-pill">{{ event.price|intcomma }} ریال</span>
                </div>
                
                <p class="card-text text-secondary small">{{ event.description|truncatewords:20 }}</p>
                
                <div class="mt-auto">
                    <div class="d-flex justify-content-between text-muted small mb-3">
                        <!-- نمایش تاریخ به فرمت پیش‌فرض جنگو (ماه میلادی رو به فارسی مینویسه) -->
                        <span><i class="far fa-calendar-alt ms-1"></i> {{ event.date|date:"d F Y" }}</span>
                        <span><i class="far fa-clock ms-1"></i> {{ event.date|time:"H:i" }}</span>
                    </div>

                    {% if user.is_authenticated %}
                        <a href="{% url 'book_ticket' event.id %}" class="btn btn-custom w-100 rounded-pill shadow-sm">
                            رزرو بلیط <i class="fas fa-arrow-left me-1"></i>
                        </a>
                    {% else %}
                        <a href="/accounts/login/" class="btn btn-outline-primary w-100 rounded-pill">
                            برای خرید وارد شوید
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12 text-center">
        <div class="alert alert-info">در حال حاضر رویدادی تعریف نشده است.</div>
    </div>
    {% endfor %}
</div>
{% endblock %}
